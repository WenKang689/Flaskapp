<form method="get" action="{{ url_for('laptop_filter') }}">
    <!-- Search Bar -->
    <label for="search">Search:</label>
    <input type="text" id="search" name="search" value="{{ request.args.get('search', '') }}"><br>

    <!-- Brand Filter -->
    <label for="brand">Brand:</label>
    <select id="brand" name="brand">
        <option value="">Any</option>
        {% for option in brands %}
            <option value="{{ option }}" {% if request.args.get('brand') == option %}selected{% endif %}>{{ option }}</option>
        {% endfor %}
    </select><br>

    <!-- Memory Filter -->
    <label for="memory">Memory:</label>
    <select id="memory" name="memory">
        <option value="">Any</option>
        {% for option in memories %}
            <option value="{{ option }}" {% if request.args.get('memory') == option %}selected{% endif %}>{{ option }}</option>
        {% endfor %}
    </select><br>

    <!-- Graphics Filter -->
    <label for="graphics">Graphics:</label>
    <select id="graphics" name="graphics">
        <option value="">Any</option>
        {% for option in graphics_options %}
            <option value="{{ option }}" {% if request.args.get('graphics') == option %}selected{% endif %}>{{ option }}</option>
        {% endfor %}
    </select><br>

    <!-- Storage Filter -->
    <label for="storage">Storage:</label>
    <select id="storage" name="storage">
        <option value="">Any</option>
        {% for option in storages %}
            <option value="{{ option }}" {% if request.args.get('storage') == option %}selected{% endif %}>{{ option }}</option>
        {% endfor %}
    </select><br>

    <!-- Battery Filter -->
    <label for="battery">Battery:</label>
    <select id="battery" name="battery">
        <option value="">Any</option>
        {% for option in batteries %}
            <option value="{{ option }}" {% if request.args.get('battery') == option %}selected{% endif %}>{{ option }}</option>
        {% endfor %}
    </select><br>

    <!-- Power Supply Filter -->
    <label for="power_supply">Power Supply:</label>
    <select id="power_supply" name="power_supply">
        <option value="">Any</option>
        {% for option in power_supplies %}
            <option value="{{ option }}" {% if request.args.get('power_supply') == option %}selected{% endif %}>{{ option }}</option>
        {% endfor %}
    </select><br>

    <!-- Operating System Filter -->
    <label for="os">Operating System:</label>
    <select id="os" name="os">
        <option value="">Any</option>
        {% for option in operating_systems %}
            <option value="{{ option }}" {% if request.args.get('os') == option %}selected{% endif %}>{{ option }}</option>
        {% endfor %}
    </select><br>

    <!-- Price Range Slider -->
    <label for="price_range">Price Range:</label>
    <div>
        <label for="min_price">Min:</label>
        <input type="range" id="min_price" name="min_price" min="{{ min_price }}" max="{{ max_price }}" value="{{ request.args.get('min_price', min_price) }}" oninput="document.getElementById('min_price_output').value = this.value">
        <output id="min_price_output">{{ request.args.get('min_price', min_price) }}</output>
    </div>
    <div>
        <label for="max_price">Max:</label>
        <input type="range" id="max_price" name="max_price" min="{{ min_price }}" max="{{ max_price }}" value="{{ request.args.get('max_price', max_price) }}" oninput="document.getElementById('max_price_output').value = this.value">
        <output id="max_price_output">{{ request.args.get('max_price', max_price) }}</output>
    </div><br>

    <script>
        document.querySelector('form').addEventListener('submit', function(event) {
            var minPrice = parseFloat(document.getElementById('min_price').value);
            var maxPrice = parseFloat(document.getElementById('max_price').value);
            if (minPrice > maxPrice) {
                alert('Max price must be greater than min price.');
                event.preventDefault(); // Prevent form submission
            }
        });
    </script>

    <button type="submit">Filter</button>
</form> 

{% if message %}
    <p>{{ message }}</p>
{% else %}
    <ul>
        {% for laptop in laptops %}
            <li><a href="{{ url_for('laptop_detail', product_id=laptop[0]) }}">{{ laptop[1] }}</a> - {{ laptop[2] }} - ${{ laptop[3] }}</li>
        {% endfor %}
    </ul>
{% endif %}